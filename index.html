<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta property="og:type" content="website">
<meta property="og:title" content="Emntee">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="Emntee">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Emntee">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/"/>





  <title>Emntee</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Emntee</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/01/27/赋闲在家后/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jian Xu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Emntee">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/01/27/赋闲在家后/" itemprop="url">赋闲在家后</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-01-27T20:46:17+08:00">
                2018-01-27
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>“没工作是件折磨人的事。”<br>离十月底辞职已经快两个月了。现在年关将近，自己却依然还是没有找到一份工作。“年味渐浓”在我人生中第一次有了种倒计时的感觉，一天一天，一周一周。<br>离职的一大苦恼在于自给自足状态的终结。在离职后第一个月花光了所有积蓄，没有收入，只能靠着爸妈的资助过日子，这样的状态难免让人觉得又沮丧又羞愧。总觉得自己的头上贴着“无能又无用”的标签。自尊心强这一刻从催人向上的动力腐化成久久弥散不开的压抑感。久而久之，整个人大概都苍白无趣了吧。。。这种感觉让人觉得讨厌，但更多的是害怕。我害怕自己变得无趣，失去吸引力，继而终于在有一天又变得孤身一人，我害怕自己变得无趣，因而给身边的人造成无形的压力。于是，沮丧又愧疚，我开始如此地过着。<br>“伟大诞生于平凡。”<br>我过去是如此的笃信着。以前知道那些光彩熠熠的人和他们的故事时，我想着去靠近他们，我试着去总结为什么他们可以那么成功，过得那么潇洒。是的，我总结过：他们有着自己的一技之长，并且这长度远远超出了大部分人。继而这一技之长成为他们的专注点和着力点。他们在上面反复施加力，反复精雕打磨。成倍的时间，投入与专注，这让他们在各自擅长的领域比大多数人都更有发言权，于是他们可以兜售自己的经验，凭借自己的履历获得体面的工作、生活和可以付出更高级的努力的机会。而我自己却还像个在海边捡贝壳的孩子一样，捡到一个，丢掉一个。我希望我的生活有一个重心，但我却又害怕为一个错误的选择付出全部，我害怕自己付出了全部，却没法在人群中挤到自己期待的位置。我觉得我没有那样的运气，用自己的亲身经历去印证“伟大诞生于平凡”这句话。<br>于是，我不敢拼。<br>我曾不敢拼。现在貌似。。我连拼的机会都没有。而那些闪着光芒的同类不断地让我感到害怕与恐惧——我在他们身上看到了自己的无能与怯懦。这个曾经仿佛看到某几段通往成功道路的人，现在是如此地窝囊与孱弱，如此可笑地谦卑了。<br>自我否定，没有工作的另一大苦恼。<br>但苦恼来苦恼去的，真的就没有那么一丢丢的收获吗？应该还是有的吧。<br>认清自己。这大概是无论什么时候离开这份工作都会有的收获。我从这份工作收获了满足，但也沾染上了狂妄，有时候甚至觉得自己有点无所不能。但没有了工作，我发现自己终究还是个脱离群体就难以自给的普通人，那种无力感或许会让我被动地学会谦虚，明白“裸辞”对自己来说并不是个轻松的事，这个社会需要的人可能比自己有用多了。<br>说完虚的，来点干货吧，交了学费，那或多或少也知道了点什么，有那么点长进了。自我总结下来，大概有以下几点：</p>
<ol>
<li>千万不要在年末辞职，这个时候招人的公司很少，除非你很牛，很有自信，但年前一个月大概只能靠运气了吧。</li>
<li>有做web后台开发意愿的平时还是学点数据库知识，关系型，非关系型都了解那么一些。</li>
<li>平时写写博客，把一些经验或者生活感想啥的网上贴，当然最好还是自己的，这样也算是锻炼自己的表达能力，同时找工作时可以贴上自己的个人博客，这也是个加分项。</li>
<li>有时间可以找一些项目，做网站的可以试着模仿某些著名的网站，做一些简化版，增加增加经验。</li>
<li>平时有时间，看看招工的网站，看看其他企业需要什么样的技术人员，以此做参照完善自己的能力集。<br>大概先总结出这么些吧。希望自己开过年来能找到一份不错的工作，也希望自己的生活能尽可能少地受到这个状态的影响。</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2018/01/26/redis-tutorial/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jian Xu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Emntee">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/01/26/redis-tutorial/" itemprop="url">redis tutorial</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-01-26T17:00:51+08:00">
                2018-01-26
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>一些redis的基本操作：</p>
<ol>
<li>设置，获取值操作<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SET</span> <span class="keyword">server</span>:<span class="keyword">name</span> <span class="string">"fido"</span></span><br><span class="line"><span class="keyword">GET</span> <span class="keyword">server</span>:<span class="keyword">name</span> =&gt; <span class="string">"fido"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SET</span> connections <span class="number">10</span></span><br><span class="line">INCR connections =&gt; <span class="number">11</span></span><br><span class="line">INCR connections =&gt; <span class="number">12</span></span><br><span class="line">DEL connections</span><br><span class="line">INCR connections =&gt; <span class="number">1</span></span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>之所以添加INCR这样的操作而非选择让用户取数据，自增，再重新赋值是为了保证redis数据内部操作的原子性，以防多个用户进行INCR操作时发生覆盖。<br>另外还有一个当键不存在时生效的设值操作<br><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SETNX connections 12 =&gt; SET if not exist</span><br></pre></td></tr></table></figure></p>
<ol>
<li><p>设值有效期操作<br>设置有效期主要通过两个命令<code>EXPIRE</code>和<code>TTL</code></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SET</span> <span class="keyword">resource</span>:<span class="keyword">lock</span> <span class="string">"Redis Demo"</span></span><br><span class="line"><span class="keyword">EXPIRE</span> <span class="keyword">resource</span>:<span class="keyword">lock</span> <span class="number">120</span></span><br><span class="line"># <span class="number">7</span>s后</span><br><span class="line">TTL <span class="keyword">resource</span>:<span class="keyword">lock</span> =&gt; <span class="number">113</span></span><br><span class="line"># <span class="number">113</span>s后</span><br><span class="line">TTL <span class="keyword">resource</span>:<span class="keyword">lock</span> =&gt; <span class="number">-2</span></span><br><span class="line"># <span class="number">-2</span>指该键不存在了（过期了）</span><br><span class="line"><span class="keyword">GET</span> <span class="keyword">resource</span>:<span class="keyword">lock</span> =&gt; nil</span><br><span class="line"># nil相当于<span class="keyword">none</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">SET</span> foo <span class="number">120</span></span><br><span class="line"># <span class="number">3</span>s后</span><br><span class="line">TTL foo <span class="number">117</span></span><br><span class="line"># 重新设值</span><br><span class="line"><span class="keyword">SET</span> foo <span class="number">12</span></span><br><span class="line"># <span class="number">1.</span> 重新设值会重置该键的生命周期 <span class="number">2.</span> <span class="number">-1</span>代表该键不会过期</span><br><span class="line">TTL foo <span class="number">-1</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>列表（list）<br>Redis支持一些复杂数据结构，首先我们先来看一下列表的操作。列表操作中最主要的几个命令分别是<code>RPUSH</code>, <code>LPUSH</code>, <code>LLEN</code>, <code>LRANGE</code>, <code>LPOP</code>以及 <code>RPOP</code>。  </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"># RPUSH是往列表尾部添加新的值</span><br><span class="line">127.0.0.1:6379&gt; RPUSH friends "Alice"</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; RPUSH friends "Bob"</span><br><span class="line">(integer) 2</span><br><span class="line"># LPUSH是往列表首部添加新的值</span><br><span class="line">127.0.0.1:6379&gt; LPUSH friends "Sam"</span><br><span class="line">(integer) 3</span><br><span class="line">127.0.0.1:6379&gt; LPUSH friends "Tom"</span><br><span class="line">(integer) 4</span><br><span class="line">127.0.0.1:6379&gt; LPUSH friends "Jill"</span><br><span class="line">(integer) 5</span><br><span class="line"># LRANGE类似于python的切片，用于获取第一个index到第二个index之间的值，其中第二个索引支持负值。</span><br><span class="line">127.0.0.1:6379&gt; LRANGE friends 0 -1</span><br><span class="line">1) "Jill"</span><br><span class="line">2) "Tom"</span><br><span class="line">3) "Sam"</span><br><span class="line">4) "Alice"</span><br><span class="line">5) "Bob"</span><br><span class="line">127.0.0.1:6379&gt; LRANGE friends 0 -2</span><br><span class="line">1) "Jill"</span><br><span class="line">2) "Tom"</span><br><span class="line">3) "Sam"</span><br><span class="line">4) "Alice"</span><br><span class="line">127.0.0.1:6379&gt; LRANGE friends 1 -2</span><br><span class="line">1) "Tom"</span><br><span class="line">2) "Sam"</span><br><span class="line">3) "Alice"</span><br><span class="line">127.0.0.1:6379&gt; LRANGE friends 2 -2</span><br><span class="line">1) "Sam"</span><br><span class="line">2) "Alice"</span><br><span class="line"># LLEN用于获取列表长度</span><br><span class="line">127.0.0.1:6379&gt; LLEN friends</span><br><span class="line">(integer) 5</span><br><span class="line"># LPOP会对列表首部（左侧）第一个元素进行pop操作</span><br><span class="line">127.0.0.1:6379&gt; LPOP friends</span><br><span class="line">"Jill"</span><br><span class="line">127.0.0.1:6379&gt; LRANGE friends 0 -1</span><br><span class="line">1) "Tom"</span><br><span class="line">2) "Sam"</span><br><span class="line">3) "Alice"</span><br><span class="line">4) "Bob"</span><br><span class="line"># RPOP则是对列表尾部（右侧）第一个元素进行pop操作。</span><br><span class="line">127.0.0.1:6379&gt; RPOP friends</span><br><span class="line">"Bob"</span><br><span class="line">127.0.0.1:6379&gt; LRANGE friends 0 -1</span><br><span class="line">1) "Tom"</span><br><span class="line">2) "Sam"</span><br><span class="line">3) "Alice"</span><br></pre></td></tr></table></figure>
</li>
<li><p>集合（SET）<br>集合与列表类似，它的行为与数学意义上的集合相似。内部元素无序，唯一。集合的几个主要操作命令有SADD, SREM, SISMEMBER, SMEMBERS, SUNION</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; SADD superpowers "flight"</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; SADD superpowers "x-ray vision"</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; SADD superpowers "reflexes"</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; SMEMBERS superpowers</span><br><span class="line">1) "reflexes"</span><br><span class="line">2) "flight"</span><br><span class="line">3) "x-ray vision"</span><br><span class="line">127.0.0.1:6379&gt; SREM superpowers "reflexes"</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; SISMEMBER superpowers "flight"</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; SISMEMBER superpowers "reflexes"</span><br><span class="line">(integer) 0</span><br><span class="line">127.0.0.1:6379&gt; SADD birdpowers "pecking"</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; SADD birdpowers "flight"</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; SUNION superpowers birdpower</span><br><span class="line">1) "flight"</span><br><span class="line">2) "pecking"</span><br><span class="line">3) "x-ray vision"</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>为了处理集合无序的特性，redis新增了有序集合（sorted set），通过为每个值附加上一个score来对数值进行排序。<br><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; ZADD hackers 1953 "Richard Stallman"</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; ZADD hackers 1965 "Yokihiro Matsumoto"</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; ZADD hackers 1916 "Claude Shannon"</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; ZADD hackers 1969 "Linus Torvalds"</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; ZADD hackers 1957 "Sophie Wilson"</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; ZADD hackers 1912 "Alan Turing"</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; ZRANGE hackers 2 4</span><br><span class="line">1) "Claude Shannon"</span><br><span class="line">2) "Alan Kay"</span><br><span class="line">3) "Richard Stallman"</span><br></pre></td></tr></table></figure></p>
<ol>
<li>哈希值（Hashes）<br>哈希值是字符型字段与字符型值之间的映射关系，很适合中规中矩地描述对象。<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"># 设值</span><br><span class="line">127.0.0.1:6379&gt; HSET user:1000 name "John Smith"</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; HSET user:1000 email "john.smith@example.com"</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; HSET user:1000 password "s3cret"</span><br><span class="line">(integer) 1</span><br><span class="line"># 查看完整对象</span><br><span class="line">127.0.0.1:6379&gt; HGETALL user:1000</span><br><span class="line">1) "name"</span><br><span class="line">2) "John Smith"</span><br><span class="line">3) "email"</span><br><span class="line">4) "john.smith@example.com"</span><br><span class="line">5) "password"</span><br><span class="line">6) "s3cret"</span><br><span class="line"># 一次性添加多个属性</span><br><span class="line">127.0.0.1:6379&gt; HMSET user:1001 name "Mary Jones" password "hidden" email "mjones@example.com"</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; HGETALL user:1001</span><br><span class="line">1) "name"</span><br><span class="line">2) "Mary Jones"</span><br><span class="line">3) "password"</span><br><span class="line">4) "hidden"</span><br><span class="line">5) "email"</span><br><span class="line">6) "mjones@example.com"</span><br><span class="line"># 获取单个属性</span><br><span class="line">127.0.0.1:6379&gt; HGET user:1001 name</span><br><span class="line">"Mary Jones"</span><br><span class="line"># 数值操作</span><br><span class="line">127.0.0.1:6379&gt; HSET user:1000 visits 10</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; HINCRBY user:1000 visits 1</span><br><span class="line">(integer) 11</span><br><span class="line">127.0.0.1:6379&gt; HINCRBY user:1000 visits 10</span><br><span class="line">(integer) 21</span><br><span class="line">127.0.0.1:6379&gt; HDEL user:1000 visits</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; HINCRBY user:1000 visits 1</span><br><span class="line">(integer) 1</span><br><span class="line">127.0.0.1:6379&gt; HGETALL user:1000</span><br><span class="line">1) "name"</span><br><span class="line">2) "John Smith"</span><br><span class="line">3) "email"</span><br><span class="line">4) "john.smith@example.com"</span><br><span class="line">5) "password"</span><br><span class="line">6) "s3cret"</span><br><span class="line">7) "visits"</span><br><span class="line">8) "1"</span><br></pre></td></tr></table></figure></li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/06/18/tcl-tutorial/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jian Xu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Emntee">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/06/18/tcl-tutorial/" itemprop="url">tcl tutorial</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-18T15:45:26+08:00">
                2017-06-18
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="tcl命令"><a href="#tcl命令" class="headerlink" title="tcl命令"></a>tcl命令</h1><ol>
<li><p>通用格式<br> commandName argument1 argument2 … argumentN<br> 例如:</p>
<pre><code>puts &quot;hello world&quot;
</code></pre></li>
<li><p>参数合并<br> 上例通过 “”来将”hello”与”world”两个参数归纳成一个，除此以外还可以使用{}来进行同样操作。</p>
<pre><code>puts {hello world}
</code></pre></li>
<li><p>命令替换<br> 我们可以通过方括号进行命令替换:</p>
<pre><code>puts [ expr 1 + 2 ]
# 即cmd  [ cmd  arg1 arg2 arg3 ]
</code></pre></li>
<li><p>变量替换<br> tcl中长通过$来获取该变量的内容,如：</p>
<pre><code>set a 12
puts $a
</code></pre></li>
</ol>
<h1 id="tcl数据类型"><a href="#tcl数据类型" class="headerlink" title="tcl数据类型"></a>tcl数据类型</h1><ol>
<li><p>简单tcl对象  </p>
<p> tcl的原始数据类型为字符串，tcl中随处可见字符串，引用这类的原始数据类型。通过这些原始数据类型，我们可以创建出复杂的数据类型列表和关联数组。同时数据类型不但可以表示简单的tcl对象，还可以表示相关的句柄，如图形对象，IO通道等等。<br> 例1：  </p>
<pre><code>set myVar 18    #这里面myVar被赋值为18，并以18的字符串的形式存储。  
puts [expr $myVar + 6 + 9 ] #这里面myVar会被提取出来，并被判断以整数的形式处理。
</code></pre></li>
<li><p>字符串</p>
<p> 在tcl中字符串不需要用单（双）引号括起来，正常没加$执行取值操作就默认为字符串。<br> 例2：</p>
<pre><code>set myVar hello
puts $myVar
</code></pre><p> 但如果存在多个字符串（注意，是多个而不是包含空格的字符串），我们可以通过前面提到的双引号””或者花括号{}把它们包括起来，表示这是个字符串列表。</p>
<pre><code>set myVar &quot;hello world&quot;
puts $myVar
# 或者
set myVar {hello world}
puts $myVar
# 但要注意的是myVar在这里并不是以字符串&quot;hello world&quot;的形式存储的，而是以&quot;hello&quot;, &quot;world&quot;组成的列表的形式存储的。
</code></pre></li>
</ol>
<ol>
<li><p>列表</p>
<p> 列表是一组元素，通过{}或者双引号组合在一起。</p>
<pre><code>set myVar {a b c}
puts [lindex $myVar 0]  # a
# 注意以下操作
set myList {$myVar d}   # $myList == {a b c d}
</code></pre></li>
<li><p>关联数组</p>
<p> 关联数组类似于python字典，通过索引来获取value。</p>
<pre><code>set myDict(a) 1
puts myDict(a)  # 1
</code></pre></li>
<li><p>句柄</p>
<p> 句柄通常用于表示（类）文件或者图像对象。包括文件，网络请求，如串口通讯，套接字，I/O设备等。</p>
<pre><code>set myFile [ open &quot;test.txt&quot; r]
</code></pre></li>
</ol>
<h1 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h1><ol>
<li><p>变量命名</p>
<p> 变量命名相对比较自由，只要可以作为一个唯一的标志，甚至可以包含空格（包含在大括号内即可），标准语法为:</p>
<pre><code>set variableName value

set variableA 10
set {variable B} test   # 明显不推荐这种做法
puts $variableA
puts ${variable B}
</code></pre></li>
<li><p>动态类型</p>
<p> tcl的数据类型与python类似，均使用动态类型，如一个数字5，它会以字符串“5”的形式存储，但执行加减或者其他需要被当作数字操作时，它会被转化为数字。</p>
<pre><code>set variableA &quot;10&quot;
puts $variableA
set sum [expr $variableA +20];
puts $sum
</code></pre></li>
<li><p>数学表达式</p>
<p> 执行数学运算的命令是expr,但注意tcl的运算机制与C类似，要想获取浮点运算结果，参数中至少存在一个浮点数。</p>
<pre><code>set variableA &quot;10&quot;
set result [expr $variableA / 9];
puts $result
set result [expr $variableA / 9.0];
puts $result
set variableA &quot;10.0&quot;
set result [expr $variableA / 9];
puts $result

# 当然还有些其他做法，但不推荐
puts [expr $variableA.0 / 20]   # 从这里面会先执行取值操作，并将$variableA替换,expr会将该值与后面的.0一并读取，并依据需求转化为数字。
</code></pre><p> 另外我们还可以通过tcl_precision关键字来设置小数点精确度</p>
<pre><code>set variableA &quot;10&quot;
set tcl_precision 5
puts [expr $variableA / 9.0]    # 1.1111
</code></pre></li>
</ol>
<h1 id="运算符"><a href="#运算符" class="headerlink" title="运算符"></a>运算符</h1><pre><code>待新增...
</code></pre><h1 id="决策"><a href="#决策" class="headerlink" title="决策"></a>决策</h1><pre><code>tcl的逻辑判断主要包括以下几种形式：
</code></pre><ol>
<li><p>if</p>
<p>使用方法：</p>
<pre><code>if {bool_expr} { # statements will be executed according to condition }
</code></pre><p>如：</p>
<pre><code>set a 10

#check the boolean condition using if statement
if { $a &lt; 20 } {
   # if condition is true then print the following 
   puts &quot;a is less than 20&quot; 
}
puts &quot;value of a is : $a&quot; 

# 这里面个人推测是由于if操作符的原因， 参数 { $a &lt; 20 }被自动转化为布尔量，即执行了[expr $a &lt; 20]的操作，所以以下这种方式也是可以的。
set a 10

#check the boolean condition using if statement
if [expr $a &lt; 20 ] {
   # if condition is true then print the following 
   puts &quot;a is less than 20&quot; 
}
puts &quot;value of a is : $a&quot; 
</code></pre><p>想到if自然忘不掉else了，那么接下来就是if … else … 的使用方法</p>
<pre><code>if { bool_expr1 } { 
    statements will be executed if expr1 is true 
} else {
    statements will be executed if expr1 is false 
}
</code></pre><p>接下来是多个if … else … 组合  </p>
<pre><code>if { bool_expr1 } { 
    statements will be executed if expr1 is true 
} elseif { bool_expr2 } {
    statements will be executed if expr2 is true 
} elseif { bool_expr3 } {
    statements will be executed if expr3 is true
} else {
    statements will be executed if none of the above is true
}
</code></pre><p>具体事例就拿成绩评级来做个演示吧</p>
<pre><code>set a 100
set level &quot;tbd&quot;

if { $a &lt; 60 } {
    set level &quot;e&quot;
} elseif { $a &lt; 70 } {
    set level &quot;d&quot;
} elseif { $a &lt; 80 } {
    set level &quot;c&quot;
} elseif { $a &lt; 90 } {
    set level &quot;b&quot;
} elseif { $a &lt; 100 } {
    set level &quot;a&quot;
} else {
    set level &quot;s&quot;
}
</code></pre><p>或者通过嵌套if语句格式来进行一些细化工作</p>
<pre><code>...
elseif { $a &lt; 100 } {
    if { $a &lt; 98 } {
        set level &quot;a&quot;
    } else {
        set level &quot;a+&quot;
    }
}
...
</code></pre></li>
<li><p>switch</p>
<p> 功能同C中的switch,语法有加引号与未加引号两种。</p>
<pre><code># 未加引号
switch switchingString matchString1 {body1} matchString2 {body2} ... matchStringN {bodyN}

# 加引号
switch switchingString {
    matchString1 {
        body1
    }
    matchString2 {
        body2
    }
    ...
    matchStringN {
        bodyN
    }
}
</code></pre><p> 类似于C,tcl中的switch也可以使用默认选项(default)</p>
<p> 这里给个依据等级给评价的例子</p>
<pre><code>set grade B
switch $grade {
    A {
        puts &quot;well done&quot;
    }
    B {
        puts &quot;good&quot;
    }
    C {
        puts &quot;not bad&quot;
    }
    D {
        puts &quot;you passed :)&quot;
    }
    E {
        puts &quot;sorry..&quot;
    }
    default {
        puts &quot;invalid grade&quot;
    }
}
</code></pre><p> 当然，switch也是可以进行嵌套的</p>
<pre><code>switch switchingString {
   matchString1 {
      body1
      switch switchingString {
        matchString1 {
           body1
         }
         matchString2 {
           body2
         }
        ...
         matchStringn {
           bodyn
         }
      }
   }
   matchString2 {
      body2
   }
...
   matchStringn {
      bodyn
   }
}
</code></pre><p> switch与if … else …之间的区别在于switch不支持逻辑判断。</p>
<pre><code>set a 100

switch $a {
    {$a &gt; 100} {
        puts &quot;a is larger than 100&quot;
    }
    { $a &lt; 100 } {
        puts &quot;a is samller than 100&quot;
    }
    { $a == 100 } {
        puts &quot;a is 100&quot;
    }
}

# 可以看成
set a 100

switch $a {
    { 100 &gt; 100 } {
        puts &quot;a is larger than 100&quot;
    }
    { 100 &lt; 100 } {
        puts &quot;a is samller than 100&quot;
    }
    { 100 == 100 } {
        puts &quot;a is 100&quot;
    }
}
显然没有一个是与100等价的。
</code></pre></li>
</ol>
<h1 id="循环"><a href="#循环" class="headerlink" title="循环"></a>循环</h1><p>循环主要包括以下几种:while, for, 同样支持控制语句:break,continue  </p>
<ol>
<li><p>while<br> 直接上例子</p>
<pre><code>set a 10
while { $a &lt; 20 } {
    puts &quot;value of a: $a&quot;
    incr a
}
</code></pre></li>
<li><p>for<br> for的语法:</p>
<pre><code>for {initialization} {condition} {increment} {
    statement(s)
}

# 初始化以及增量语句如果不需要使用可使用分号作占位符

for {;} {$a &lt; 20} {;} { puts &quot;do something&quot;}
</code></pre><p> 给一个20内跳过前五的循环例子</p>
<pre><code>for { set a 0 } { $a &lt; 20 } { incr a } {
    if { $a &lt; 5 } { 
        continue 
    } else {
        puts &quot;do something&quot;
    }
}
</code></pre><p> 嵌套与break, continue的用法在这里就不做介绍了。</p>
</li>
</ol>
<h1 id="数组"><a href="#数组" class="headerlink" title="数组"></a>数组</h1><p>tcl中存在数组，关联数组等说法，但本质上都是键值对，无非一般数组使用数字字符作为键而关联数组则相对自由一点。注意区分数组与列表，数组本质为键值对，而列表则是一组按照序列排好的变量。</p>
<p>常用设置数组的方法:</p>
<pre><code>set ArrayName(Index) value
</code></pre><p>获取数组大小可以通过如下方法：</p>
<pre><code>[array size variableName]

# 例子
set langs(0) cn
set langs(1) en
puts [array size langs] # 2
</code></pre><p>那么数组迭代就可以借助for，array size来进行。</p>
<pre><code>for { set index 0 } { $index &lt; [array size langs] } { incr index } {
    puts &quot;supported language: $langs($index)&quot;
}
</code></pre><p>如果想要获取数组内索引的列表，可以通过如下方法:</p>
<pre><code>[array names variableName]

# 例子
set personA(Name) &quot;Dave&quot;
set personA(Age) 14
puts [array names personA]
</code></pre><h1 id="字符串"><a href="#字符串" class="headerlink" title="字符串"></a>字符串</h1><p>字符串命令<br>以下命令均通过[string cmd arg1 agr2 … argN]</p>
<ol>
<li><p>compare string1 string2<br>比较字符串，如果相同就返回0</p>
<p> set s1 “Hello”<br> set s2 “World”<br> set s3 “World”<br> puts [string compare s1 s2]<br> if {[string compare s2 s3] == 0} {<br> puts “String \’s1\’ and \’s2\’ are same.”;<br> } </p>
<p> if {[string compare s1 s2] == -1} {<br> puts “String \’s1\’ comes before \’s2\’.”;<br> }</p>
<p> if {[string compare s2 s1] == 1} {<br> puts “String \’s2\’ comes before \’s1\’.”;<br> }</p>
</li>
<li><p>index string index<br>返回索引的字符</p>
<p> set s1 “Hello World”<br> set s2 “o”<br> puts “First occurrence of $s2 in s1”<br> puts [string first $s2 $s1]<br> puts “Character at index 0 in s1”<br> puts [string index $s1 0]<br> puts “Last occurrence of $s2 in s1”<br> puts [string last $s2 $s1]<br> puts “Word end index in s1”<br> puts [string wordend $s1 20]<br> puts “Word start index in s1”<br> puts [string wordstart $s1 20]</p>
</li>
<li><p>last string1 string2<br>返回string1在string2中出现的最后一次的索引</p>
</li>
</ol>
<p>set s1 “Hello World”<br>set s2 “o”<br>puts “First occurrence of $s2 in s1”<br>puts [string first $s2 $s1]<br>puts “Character at index 0 in s1”<br>puts [string index $s1 0]<br>puts “Last occurrence of $s2 in s1”<br>puts [string last $s2 $s1]<br>puts “Word end index in s1”<br>puts [string wordend $s1 20]<br>puts “Word start index in s1”<br>puts [string wordstart $s1 20]</p>
<ol>
<li>length string<br>获取字符串长度</li>
</ol>
<p>set s1 “Hello World”<br>puts “Length of string s1”<br>puts [string length $s1]</p>
<ol>
<li><p>match pattern string<br>如果匹配，返回1</p>
<p> set s1 “test@test.com”<br> set s2 “<em>@</em>.com”<br> puts “Matching pattern s2 in s1”<br> puts [string match “<em>@</em>.com” $s1 ]<br> puts “Matching pattern tcl in s1”<br> puts [string match {tcl} $s1]</p>
</li>
<li><p>range string index1 index2<br>获取指定索引范围内的字符串</p>
</li>
<li><p>tolower string<br>返回小写字符串</p>
</li>
<li><p>toupper string<br>返回大写字符串</p>
<p> set s1 “Hello World”<br> puts “Uppercase string of s1”<br> puts [string toupper $s1]<br> puts “Lowercase string of s1”<br> puts [string tolower $s1]</p>
</li>
<li><p>trim string ?trimcharactors?</p>
<p> set s1 “Hello World”<br> set s2 “World”<br> puts “Trim right $s2 in $s1”<br> puts [string trimright $s1 $s2]</p>
<p> set s2 “Hello”<br> puts “Trim left $s2 in $s1”<br> puts [string trimleft $s1 $s2]</p>
<p> set s1 “ Hello World “<br> set s2 “ “<br> puts “Trim characters s1 on both sides of s2”<br> puts [string trim $s1 $s2]</p>
</li>
<li><p>trimleft/right string ?trimcharactors?</p>
</li>
<li><p>wordend/start findstring index</p>
</li>
<li><p>append</p>
<p>set s1 “Hello”<br>append s1 “ World”<br>puts $s1</p>
</li>
<li><p>format  </p>
<p>|指示符|使用|<br>|:–|:–|<br>|%s|字符串表示|<br>|%d|整数表示|<br>|%f|浮点表示|<br>|%e|指数形式浮点表示|<br>|%x|十六进制表示|</p>
</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/06/07/git-tutorial/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jian Xu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Emntee">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/06/07/git-tutorial/" itemprop="url">git tutorial</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-07T21:10:24+08:00">
                2017-06-07
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="some-basic-commands-in-git"><a href="#some-basic-commands-in-git" class="headerlink" title="some basic commands in git"></a>some basic commands in git</h1><h2 id="for-local-operation"><a href="#for-local-operation" class="headerlink" title="for local operation"></a>for local operation</h2><ol>
<li><p>initializtion<br><code>git init</code><br>initialize a repo for your work  </p>
</li>
<li><p>update a commit<br><code>git add</code><br>step 1. add file top stage( or index)<br><code>git commit -m &quot;comment&quot;</code><br>step 2. make the commit operation with a comment  </p>
</li>
<li>version reverse<br><code>git reset --hard HEAD^*</code><br>or <code>git reset --hard HEAD^~n</code><br>how many reverse operation will be executed depends on how many “^” included or the “n” after “~”<br>pay attention to HEAD, index(or stage) and master here. HEAD is the pointer which points to the current version, after every version switch, it will point to the very version.  index play the role of storage for <code>what has changed</code> compared to the current master branch. After commit operation, contents in index will be pushed to master. How many add operations you’ve performed, changes will be stored in index, and after one commit operation, all changes will be merged into master at once.</li>
<li>interversion jump<br><code>git reset --hard commit id</code><br>no need to input the full commit id, just ensure its identical enough, 7 bits is recommended  </li>
<li>cancellation<br><code>git checkout file</code><br>more exactly is get a copy from master branch, can be useful when you’ve get your file all of a mess, and you just want to restore it.  </li>
<li>remove file<br><code>git rm file</code><br>…  </li>
<li>take a look at what you’ve done<br><code>git log</code> or <code>git reflog</code><br><code>git log</code> shows you how many versions are till now has been committed except those dropped by you. like when you switch from 9 to 7, 8, 9 will not show in log, but they are also points you can restore to. To make this, you need <code>reflog</code>.<br><code>git reflg</code> shows you all operations you had executed, at the first part of the line, you will know which version is now up to after execution of the command. when you restored from 9 to 8, you can get commit id of 9 in previous operation history record.</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/06/05/socket-and-IO/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Jian Xu">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Emntee">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2017/06/05/socket-and-IO/" itemprop="url">一些关于python socket和server的东西</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-06-05T21:26:33+08:00">
                2017-06-05
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Socket-and-SocketServer"><a href="#Socket-and-SocketServer" class="headerlink" title="Socket and SocketServer"></a>Socket and SocketServer</h1><h2 id="Socket"><a href="#Socket" class="headerlink" title="Socket"></a>Socket</h2><p>socket提供两种功能，一种是为客户端服务的，一种是作为服务器端的基础服务单元工作。<br>作为客户端使用时，socket的使用方法还是比较简单的。在这里我们可以写一个简单的例子。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"></span><br><span class="line">HOST = <span class="string">'daring.cwi.nl'</span>    </span><br><span class="line">PORT = <span class="number">50007</span>              </span><br><span class="line"><span class="keyword">with</span> socket.socket(socket.AF_INET, socket.SOCK_STREAM) <span class="keyword">as</span> s:</span><br><span class="line">    s.connect((HOST, PORT))</span><br><span class="line">    s.sendall(<span class="string">b'Hello, world'</span>)</span><br><span class="line">    data = s.recv(<span class="number">1024</span>)</span><br><span class="line">print(<span class="string">'Received'</span>, repr(data))</span><br></pre></td></tr></table></figure></p>
<p>AF_INET是address family类型，主要是IPv4类型，UNIX也有自己的address family，但UNIX类型的不涉及ip，主要是用于IPC。另外需要注意的是python3里socket发送的均为二进制，这样可能是有效处理了大端小端的问题。<br>另外一种是作为服务器端的socket，这里处理相对是复杂一点。涉及到的主要的几个函数包括bind, listen, accept, recv, send(all)<br>下面是官方文档里的例子。<br><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"></span><br><span class="line">HOST = <span class="string">''</span>                 </span><br><span class="line">PORT = <span class="number">50007</span>              </span><br><span class="line"><span class="keyword">with</span> socket.socket(socket.AF_INET, socket.SOCK_STREAM) <span class="keyword">as</span> s:</span><br><span class="line">    s.bind((HOST, PORT))</span><br><span class="line">    s.listen(<span class="number">1</span>)</span><br><span class="line">    conn, addr = s.accept()</span><br><span class="line">    <span class="keyword">with</span> conn:</span><br><span class="line">        print(<span class="string">'Connected by'</span>, addr)</span><br><span class="line">        <span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">            data = conn.recv(<span class="number">1024</span>)</span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> data: <span class="keyword">break</span></span><br><span class="line">            conn.sendall(data)</span><br></pre></td></tr></table></figure></p>
<p>这里是一些基础的使用方法，但实际编写服务器程序时，我们还需要关注一些细节上的东西，比如使用并发提高效率等。  </p>
<h1 id="Socket-Server"><a href="#Socket-Server" class="headerlink" title="Socket Server"></a>Socket Server</h1><p>ocketserver这个模块提供了一些server的python实现，但这个模块更多的是提供了类似一个模板或者规范，类似于wsgiref。这个模块主要涉及到BaseServer, TCPServer, UDPServer, BaseRequestHandler, StreamRequestHandler, DatagramRequestHandler。<br>从BaseHttpServer入手，这里有几个接口需要关注一下，分别是server_forever, handle_one_request, get_request, verify_request, process_request, finish_request，其中</p>
<ol>
<li>serve_forever与handle_one_request两个都是用于处理请求，只不过handle_one_request只处理一个请求，而server_forever更多的是通过循环，select或者epoll这些方法来持续处理request。  </li>
<li>get_request固定返回request和address， 但TCP，UDP返回的request并不相同， TCP直接调用socket的accept方法获取socket, address， 而UDP则是通过recvfrom，最终返回socket, data作为request参数。  </li>
<li>process_request主要是从并发角度来处理request。  </li>
<li>finish_request主要工作是将request传递给handler，由handler来处理request。<br>那么这样来看，可不可以就这样认为？BaseServer以及作为分支的TCPServer, UDPServer这一段的主要功能就是获取request，然后关注任务的分发工作。因为到finish_request这一段，把request分发给handler之后，它就不再负责request的后续处理了。<br>接下来的主要工作基本都是到了HTTPServer，WSGIServer这些层面来做细化处理。</li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  


          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Jian Xu</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">5</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Jian Xu</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
